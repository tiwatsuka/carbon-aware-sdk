<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorial-basics/carbon-aware-webapi" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Carbon Aware WebApi | Carbon Aware SDK</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://carbon-aware-sdk.greensoftware.foundation/img/GSF-logo.jpg"><meta data-rh="true" name="twitter:image" content="https://carbon-aware-sdk.greensoftware.foundation/img/GSF-logo.jpg"><meta data-rh="true" property="og:url" content="https://carbon-aware-sdk.greensoftware.foundation/docs/tutorial-basics/carbon-aware-webapi"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Carbon Aware WebApi | Carbon Aware SDK"><meta data-rh="true" name="description" content="The Carbon Aware SDK provides an API to get the marginal carbon intensity for a"><meta data-rh="true" property="og:description" content="The Carbon Aware SDK provides an API to get the marginal carbon intensity for a"><link data-rh="true" rel="icon" href="/img/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://carbon-aware-sdk.greensoftware.foundation/docs/tutorial-basics/carbon-aware-webapi"><link data-rh="true" rel="alternate" href="https://carbon-aware-sdk.greensoftware.foundation/docs/tutorial-basics/carbon-aware-webapi" hreflang="en"><link data-rh="true" rel="alternate" href="https://carbon-aware-sdk.greensoftware.foundation/docs/tutorial-basics/carbon-aware-webapi" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Carbon Aware SDK RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Carbon Aware SDK Atom Feed"><link rel="stylesheet" href="/assets/css/styles.36701cc3.css">
<script src="/assets/js/runtime~main.e8e862b7.js" defer="defer"></script>
<script src="/assets/js/main.9f624a3e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#EBF2D7;color:#00524f" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><strong>‚ö† Incubation Project This project is an incubation project being run inside the Green Software Foundation; as such, we <b>DON'T</b> recommend using it in any critical use case. Incubation projects are experimental, offer no support guarantee, have minimal governance and process, and may be retired at any moment. This project may one day graduate, in which case this disclaimer will be removed. <br><br> üéâÔ∏è We are running a Hackathon! CarbonHack is open to all, including software practitioners and those with a passion for Green Software. Find out more on the <a href="https://grnsft.org/hack/github">CarbonHack website</a> </strong></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/GSF-logo.jpg" alt="Carbon Aware SDK Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/GSF-logo.jpg" alt="Carbon Aware SDK Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Carbon Aware SDK</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/quickstart">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a href="https://greensoftware.foundation/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GSF</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Green-Software-Foundation/carbon-aware-sdk" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/overview">Overview</a><button aria-label="Expand sidebar category &#x27;Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/quickstart">Setting up and using the Carbon Aware SDK</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="Collapse sidebar category &#x27;Tutorial - Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial-basics/carbon-aware-cli">Carbon Aware CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial-basics/carbon-aware-github-action">Carbon Aware Github Action</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial-basics/carbon-aware-tools">Carbon Aware Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/tutorial-basics/carbon-aware-webapi">Carbon Aware WebApi</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial-basics/containerization">Containerized WebApi</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="Expand sidebar category &#x27;Tutorial - Extras&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/architecture">Architecture</a><button aria-label="Expand sidebar category &#x27;Architecture&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/samples">Samples</a><button aria-label="Expand sidebar category &#x27;Samples&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/tutorial---basics"><span itemprop="name">Tutorial - Basics</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Carbon Aware WebApi</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1 id="carbon-aware-webapi">Carbon Aware WebApi</h1>
<p>The Carbon Aware SDK provides an API to get the marginal carbon intensity for a
given location and time period. The values reported in the Green Software
Foundation&#x27;s specification for marginal carbon intensity (Grams per Kilowatt
Hour).</p>
<p><strong><em>Highly Recommended</em></strong> - This user interface is best for when you can change
the code, and deploy separately. This also allows you to manage the Carbon Aware
logic independently of the system using it.</p>
<p>The WebApi replicates the CLI and SDK functionality, leveraging the same
configuration and providing a REST end point with Swagger/OpenAPI definition for
client generation</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#carbon-aware-webapi">Carbon Aware WebApi</a>
<ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#endpoints">Endpoints</a>
<ul>
<li><a href="#get-emissionsbylocation">GET emissions/bylocation</a></li>
<li><a href="#get-emissionsbylocations">GET emissions/bylocations</a></li>
<li><a href="#get-emissionsbylocationsbest">GET emissions/bylocations/best</a></li>
<li><a href="#get-emissionsforecastscurrent">GET emissions/forecasts/current</a></li>
<li><a href="#post-emissionsforecastsbatch">POST emissions/forecasts/batch</a></li>
<li><a href="#get-emissionsaverage-carbon-intensity">GET emissions/average-carbon-intensity</a></li>
<li><a href="#post-emissionsaverage-carbon-intensitybatch">POST emissions/average-carbon-intensity/batch</a></li>
<li><a href="#get-locations">GET /locations</a></li>
</ul>
</li>
<li><a href="#error-handling">Error Handling</a></li>
<li><a href="#autogenerate-webapi">Autogenerate WebAPI</a></li>
<li><a href="#data-sources">Data Sources</a>
<ul>
<li><a href="#watttime">WattTime</a>
<ul>
<li><a href="#watttime-locations">Locations</a></li>
<li><a href="#watttime-exception-handling">Exception Handling</a></li>
<li><a href="#example-emissions-call-using-watttime">Example Emissions Call Using WattTime</a></li>
</ul>
</li>
<li><a href="#electricitymaps">ElectricityMaps</a>
<ul>
<li><a href="#electricitymaps-locations">Locations</a></li>
<li><a href="#electricitymaps-exception-handling">Exception Handling</a></li>
</ul>
</li>
<li><a href="#electricitymapsfree">ElectricityMapsFree</a>
<ul>
<li><a href="#locations">Locations</a></li>
<li><a href="#exception-handling">Exception Handling</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="endpoints">Endpoints</h2>
<h3 id="get-emissionsbylocation">GET emissions/bylocation</h3>
<p>This endpoint calculates the observed emission data by location for a specified
time period.</p>
<p>Location is a required parameter and is name of the data region for the
configured Cloud provider. If time period is not provided, it retrieves
available data until the current time.</p>
<pre><code class="language-text">https://&lt;server_name&gt;/emissions/bylocation?location=useast&amp;time=2022-01-01&amp;toTime=2022-05-17
</code></pre>
<p>The response is an array of EmissionsData objects that contains the location,
time and the rating in g/kWh</p>
<pre><code class="language-json">[
  {
    &quot;location&quot;: &quot;eastus&quot;,
    &quot;time&quot;: &quot;2022-05-17T20:45:11.5092741+00:00&quot;,
    &quot;rating&quot;: 70
  }
]
</code></pre>
<h3 id="get-emissionsbylocations">GET emissions/bylocations</h3>
<p>This endpoint calculates the observed emission data by an array of locations for
a specified time period</p>
<p>Location is a required parameter and is an array of the names of the data region
for the configured Cloud provider. If time period is not provided, it retrieves
all the data until the current time.</p>
<pre><code class="language-text">https://&lt;server_name&gt;/emissions/bylocations?locations=eastus&amp;locations=westus&amp;time=2022-01-01&amp;toTime=2022-05-17
</code></pre>
<p>The response is an array of EmissionsData objects that contains the location,
time and the rating in g/kWh.</p>
<pre><code class="language-json">[
  {
    &quot;location&quot;:&quot;eastus&quot;
    &quot;time&quot;:&quot;2022-05-17T20:45:11.5092741+00:00&quot;,
    &quot;rating&quot;:70
  },
  {
    &quot;location&quot;:&quot;westus&quot;
    &quot;time&quot;:&quot;2022-05-17T20:45:11.5092741+00:00&quot;,
    &quot;rating&quot;:64
  }
]
</code></pre>
<h3 id="get-emissionsbylocationsbest">GET emissions/bylocations/best</h3>
<p>This endpoint calculates the best observed emission data by an array of
locations for a specified time period</p>
<p>Location is a required parameter and is an array of the names of the data region
for the configured Cloud provider. If time period is not provided, it retrieves
all the data until the current time.</p>
<pre><code class="language-text">https://&lt;server_name&gt;/emissions/bylocations/best?locations=eastus&amp;locations=westus&amp;time=2022-01-01&amp;toTime=2022-05-17
</code></pre>
<p>The response is an array of EmissionsData objects that contains the location,
time and the rating in g/kWh.</p>
<pre><code class="language-json">[
  {
    &quot;location&quot;:&quot;eastus&quot;
    &quot;time&quot;:&quot;2022-05-17T20:45:11.5092741+00:00&quot;,
    &quot;rating&quot;:70
  }
]
</code></pre>
<h3 id="get-emissionsforecastscurrent">GET emissions/forecasts/current</h3>
<p>This endpoint fetches only the most recently generated forecast for all provided
locations. It uses the &quot;dataStartAt&quot; and &quot;dataEndAt&quot; parameters to scope the
forecasted data points (if available for those times). If no start or end time
boundaries are provided, the entire forecast dataset is used. The scoped data
points are used to calculate average marginal carbon intensities of the
specified &quot;windowSize&quot; and the optimal marginal carbon intensity window is
identified.</p>
<p>The forecast data represents what the data source predicts future marginal
carbon intesity values to be, not actual measured emissions data (as future
values cannot be known).</p>
<p>This endpoint is useful for determining if there is a more carbon-optimal time
to use electicity predicted in the future.</p>
<p>Parameters:</p>
<ol>
<li><code>location</code>: This is a required parameter and is an array of the names of the
data region for the configured Cloud provider.</li>
<li><code>dataStartAt</code>: Start time boundary of the current forecast data points.
Ignores current forecast data points before this time. Must be within the
forecast data point timestamps. Defaults to the earliest time in the forecast
data.</li>
<li><code>dataEndAt</code>: End time boundary of the current forecast data points. Ignores
current forecast data points after this time. Must be within the forecast
data point timestamps. Defaults to the latest time in the forecast data. If
neither <code>dataStartAt</code> nor <code>dataEndAt</code> are provided, all forecasted data
points are used in calculating the optimal marginal carbon intensity window.</li>
<li><code>windowSize</code>: The estimated duration (in minutes) of the workload. Defaults
to the duration of a single forecast data point.</li>
</ol>
<pre><code class="language-text">https://&lt;server_name&gt;/emissions/forecasts/current?location=northeurope&amp;dataStartAt=2022-07-19T14:00:00Z&amp;dataEndAt=2022-07-20T04:38:00Z&amp;windowSize=10
</code></pre>
<p>The response is an array of forecasts (one per requested location) with their
optimal marginal carbon intensity windows.</p>
<pre><code class="language-json">[
  {
    &quot;requestedAt&quot;: &quot;2022-07-19T13:37:49+00:00&quot;,
    &quot;generatedAt&quot;: &quot;2022-07-19T13:35:00+00:00&quot;,
    &quot;location&quot;: &quot;northeurope&quot;,
    &quot;dataStartAt&quot;: &quot;2022-07-19T14:00:00Z&quot;,
    &quot;dataEndAt&quot;: &quot;2022-07-20T04:38:00Z&quot;,
    &quot;windowSize&quot;: 10,
    &quot;optimalDataPoint&quot;: {
      &quot;location&quot;: &quot;IE&quot;,
      &quot;timestamp&quot;: &quot;2022-07-19T18:45:00+00:00&quot;,
      &quot;duration&quot;: 10,
      &quot;value&quot;: 448.4451043375
    },
    &quot;forecastData&quot;: [
      {
        &quot;location&quot;: &quot;IE&quot;,
        &quot;timestamp&quot;: &quot;2022-07-19T14:00:00+00:00&quot;,
        &quot;duration&quot;: 10,
        &quot;value&quot;: 532.02293146
      },
      ...
      {
        &quot;location&quot;: &quot;IE&quot;,
        &quot;timestamp&quot;: &quot;2022-07-20T04:25:00+00:00&quot;,
        &quot;duration&quot;: 10,
        &quot;value&quot;: 535.7318741001667
      }
    ]
  }
]
</code></pre>
<h3 id="post-emissionsforecastsbatch">POST emissions/forecasts/batch</h3>
<p>This endpoint takes a batch of requests for historical forecast data, fetches
them, and calculates the optimal marginal carbon intensity windows for each
using the same parameters available to the &#x27;/emissions/forecasts/current&#x27;
endpoint.</p>
<p>This endpoint is useful for back-testing what one might have done in the past,
if they had access to the current forecast at the time.</p>
<p>Parameters:</p>
<ol>
<li>requestedForecasts: Array of requested forecasts. Each requested forecast
contains<!-- -->
<ul>
<li><code>requestedAt</code>: This is a required parameter and is the historical time used
to fetch the most recent forecast as of that time.</li>
<li><code>location</code>: This is a required parameter and is the name of the data region
for the configured Cloud provider.</li>
<li><code>dataStartAt</code>: Start time boundary of the forecast data points. Ignores
forecast data points before this time. Must be within the forecast data
point timestamps. Defaults to the earliest time in the forecast data.</li>
<li><code>dataEndAt</code>: End time boundary of the forecast data points. Ignores
forecast data points after this time. Must be within the forecast data
point timestamps. Defaults to the latest time in the forecast data.</li>
<li><code>windowSize</code>: The estimated duration (in minutes) of the workload. Defaults
to the duration of a single forecast data point</li>
</ul>
</li>
</ol>
<p>If neither <code>dataStartAt</code> nor <code>dataEndAt</code> are provided, all forecasted data
points are used in calculating the optimal marginal carbon intensity window.</p>
<pre><code class="language-json">[
  {
    &quot;location&quot;: &quot;eastus&quot;,
    &quot;dataStartAt&quot;: &quot;2022-06-01T14:00:00Z&quot;,
    &quot;dataEndAt&quot;: &quot;2022-06-01T18:00:00Z&quot;,
    &quot;windowSize&quot;: 30,
    &quot;requestedAt&quot;: &quot;2022-06-01T12:01:00Z&quot;
  },
  {
    &quot;location&quot;: &quot;westus&quot;,
    &quot;dataStartAt&quot;: &quot;2022-06-13T08:00:00Z&quot;,
    &quot;dataEndAt&quot;: &quot;2022-06-13T10:00:00Z&quot;,
    &quot;windowSize&quot;: 30,
    &quot;requestedAt&quot;: &quot;2022-06-13T6:05:00Z&quot;
  }
]
</code></pre>
<p>The response is an array of forecasts (one per requested location) with their
optimal marginal carbon intensity windows.</p>
<pre><code class="language-json">[
  {
    &quot;generatedAt&quot;: &quot;2022-06-01T12:00:00+00:00&quot;,
    &quot;optimalDataPoint&quot;: {
      &quot;location&quot;: &quot;IE&quot;,
      &quot;timestamp&quot;: &quot;2022-06-01T16:45:00+00:00&quot;,
      &quot;duration&quot;: 10,
      &quot;value&quot;: 448.4451043375
    },
    &quot;forecastData&quot;: [ ... ] // all relevant forecast data points
    &quot;requestedAt&quot;: &quot;2022-06-01T12:01:00&quot;
    &quot;location&quot;: &quot;eastus&quot;,
    &quot;dataStartAt&quot;: &quot;2022-06-01T14:00:00Z&quot;,
    &quot;dataEndAt&quot;: &quot;2022-06-01T18:00:00Z&quot;,
    &quot;windowSize&quot;: 30,
  },
  {
    &quot;generatedAt&quot;: &quot;2022-06-13T06:05:00+00:00&quot;,
    &quot;optimalDataPoint&quot;: {
      &quot;location&quot;: &quot;IE&quot;,
      &quot;timestamp&quot;: &quot;2022-06-13T09:25:00+00:00&quot;,
      &quot;duration&quot;: 10,
      &quot;value&quot;: 328.178478
    },
    &quot;forecastData&quot;: [ ... ] // all relevant forecast data points
    &quot;requestedAt&quot;: &quot;2022-06-13T06:05:00&quot;
    &quot;location&quot;: &quot;westus&quot;,
    &quot;dataStartAt&quot;: &quot;2022-06-13T08:00:00Z&quot;,
    &quot;dataEndAt&quot;: &quot;2022-06-13T10:00:00Z&quot;,
    &quot;windowSize&quot;: 30,
  }
]
</code></pre>
<h3 id="get-emissionsaverage-carbon-intensity">GET emissions/average-carbon-intensity</h3>
<p>This endpoint retrieves the measured carbon intensity data between the time
boundaries and calculates the average carbon intensity during that period.
Location is a required parameter and is the name of the data region for the
configured Cloud provider.</p>
<p>This endpoint is useful for reporting the measured carbon intensity for a
specific time period in a specific location.</p>
<p>Parameters:</p>
<ol>
<li><code>location</code>: This is a required parameter and is the string name of the data
region for the configured Cloud provider.</li>
<li><code>startTime</code>: The time at which the workload and corresponding carbon usage
begins.</li>
<li><code>endTime</code>: The time at which the workload and corresponding carbon usage
ends.</li>
</ol>
<pre><code class="language-text">https://&lt;server_name&gt;/emissions/average-carbon-intensity?location=eastus&amp;startTime=2022-07-19T14:00:00Z&amp;endTime=2022-07-19T18:00:00Z
</code></pre>
<p>The response is a single object that contains the information about the request
and the average marginal carbon intensity</p>
<pre><code class="language-json">{
  &quot;location&quot;: &quot;eastus&quot;,
  &quot;startTime&quot;: &quot;2022-07-19T14:00:00Z&quot;,
  &quot;endTime&quot;: &quot;2022-07-19T18:00:00Z&quot;,
  &quot;carbonIntensity&quot;: 345.434
}
</code></pre>
<h3 id="post-emissionsaverage-carbon-intensitybatch">POST emissions/average-carbon-intensity/batch</h3>
<p>This endpoint takes an array of request objects, each with their own location
and time boundaries, and calculates the average carbon intensity for that
location and time period.</p>
<p>This endpoint only supports batching across a single location with different
time boundaries. If multiple locations are provided, an error is returned. For
each item in the request array, the application returns a corresponding object
containing the location, time boundaries, and average marginal carbon intensity.</p>
<p>Parameters:</p>
<ol>
<li>requestedCarbonIntensities: Array of requested carbon intensities. Each
requested carbon intensity contains<!-- -->
<ul>
<li><code>location</code>: This is a required parameter and is the name of the data region
for the configured Cloud provider.</li>
<li><code>startTime</code>: The time at which the workflow we are requesting carbon
intensity for started.</li>
<li><code>endTime</code>: The time at which the workflow we are requesting carbon
intensity for ended.</li>
</ul>
</li>
</ol>
<pre><code class="language-json">[
  {
    &quot;location&quot;: &quot;eastus&quot;,
    &quot;startTime&quot;: &quot;2022-05-01T14:00:00&quot;,
    &quot;endTime&quot;: &quot;2022-05-01T18:00:00&quot;
  },
  {
    &quot;location&quot;: &quot;eastus&quot;,
    &quot;startTime&quot;: &quot;2022-06-01T14:00:00&quot;,
    &quot;endTime&quot;: &quot;2022-06-01T18:00:00&quot;
  },
  {
    &quot;location&quot;: &quot;eastus&quot;,
    &quot;startTime&quot;: &quot;2022-07-01T14:00:00&quot;,
    &quot;endTime&quot;: &quot;2022-07-01T18:00:00&quot;
  }
]
</code></pre>
<p>The response is an array of CarbonIntensityDTO objects which each have a
location, start time, end time, and the average marginal carbon intensity over
that time period.</p>
<pre><code class="language-json">[
  {
    &quot;carbonIntensity&quot;: 32.935208333333335,
    &quot;location&quot;: &quot;eastus&quot;,
    &quot;startTime&quot;: &quot;2022-05-01T14:00:00-04:00&quot;,
    &quot;endTime&quot;: &quot;2022-05-01T18:00:00-04:00&quot;
  },
  {
    &quot;carbonIntensity&quot;: 89.18215277777779,
    &quot;location&quot;: &quot;eastus&quot;,
    &quot;startTime&quot;: &quot;2022-06-01T14:00:00-04:00&quot;,
    &quot;endTime&quot;: &quot;2022-06-01T18:00:00-04:00&quot;
  },
  {
    &quot;carbonIntensity&quot;: 10.416875,
    &quot;location&quot;: &quot;eastus&quot;,
    &quot;startTime&quot;: &quot;2022-07-01T14:00:00-04:00&quot;,
    &quot;endTime&quot;: &quot;2022-07-01T18:00:00-04:00&quot;
  }
]
</code></pre>
<h3 id="get-locations">GET /locations</h3>
<p>This endpoint lists all the supported locations that the datasources potentially
can have access to. This information is coming from the <code>location-source/json</code>
files, that contain dictionaries in the form of <code>&lt;A Location key name, GeoCoordinates&gt;</code>, for instance:</p>
<pre><code class="language-json">{
  &quot;eastus&quot;: {
    &quot;Latitude&quot;: 37.3719,
    &quot;Longitude&quot;: -79.8164,
    &quot;Name&quot;: &quot;eastus&quot;
  },
  ...
  &quot;switzerlandnorth&quot;:{
    &quot;Latitude&quot;: 47.451542,
    &quot;Longitude&quot;: 8.564572,
    &quot;Name&quot;: &quot;switzerlandnorth&quot;
  }
}
</code></pre>
<p><code>Emissions</code> and <code>Forecasts</code> endpoints would use the location&#x27;s <code>key</code> name
returned by the <code>emssions/locations</code> endpoint.</p>
<p><strong>Note</strong>: If there is <strong><em>a location key name</em></strong> collision while loading two or
more location json files and there is no <code>LocationDataSourcesConfiguration</code>
<code>Prefix</code> and/or <code>Delimiter</code> settings, the system would change the collision key
name by appending an underscore character and a sequence number to it (i.e.
<code>&lt;key name&gt;</code><strong><em>_seqnumber</em></strong>). For instance two location json files having
<code>swedencentral</code> as key, after loading, it would become:</p>
<pre><code class="language-json">{
  &quot;swedencentral&quot;: {
    &quot;Latitude&quot;: 60.67488,
    &quot;Longitude&quot;: 17.14127,
    &quot;Name&quot;:&quot;swedencentral&quot;
  },
  ...
  &quot;swedencentral_1&quot;: { // key collision. key renamed.
    &quot;Latitude&quot;: null,
    &quot;Longitude&quot;: null,
    &quot;Name&quot;: &quot;SE&quot;
  },
  ...
}
</code></pre>
<p>If there is a third file with the same key name, it would be <code>swedencentral_2</code>
and so on. This information is not persisted, but now the user can make requests
using <code>swedencentral</code> and/or <code>swedencentral_1</code>. Also there are log <strong><em>warning</em></strong>
entries when this scenerario occurs to help the user to understand what key
renaming happened.</p>
<pre><code class="language-sh">warn: Location key swedencentral from ... already exists. Creating new key.
...
warn: New key swedencentral_1 generated from swedencentral
CarbonAware.LocationSources.LocationSource: Warning: New key swedencentral_1 generated from swedencentral
</code></pre>
<h2 id="error-handling">Error Handling</h2>
<p>The WebAPI leveraged the
<a href="https://docs.microsoft.com/en-us/aspnet/core/mvc/controllers/filters?view=aspnetcore-8.0">.Net controller filter pipeline</a>
to ensure that all requests respond with a consistent JSON schema.</p>
<p><img src="https://docs.microsoft.com/en-us/aspnet/core/mvc/controllers/filters/_static/filter-pipeline-2.png?view=aspnetcore-8.0" alt=".Net controller filter pipeline image"></p>
<p>Controllers are responsible for managing the &quot;Success&quot; responses. If an error
occurs in the WebAPI code and an unhandled exception is thrown, the
<a href="./Filters/HttpResponseExceptionFilter.cs">custom Exception Filter</a> will manage
converting that exception into the appropriate JSON response. NOTE: The
Exception Filter is only used for unhandled exceptions. If the exception is
caught and handled by the WebAPI code, the controller will continue to manage
the response.</p>
<p>The .Net framework will automatically respond to validation errors with a
<a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.validationproblemdetails?view=aspnetcore-8.0">ValidationProblemDetails</a>
object. Using the Exception Filter class enables the WebAPI to consistently
respond with the <code>ValidationProblemDetails</code> error schema in all error cases and
take advantage of error handling automatically provided by the framework.</p>
<p><img alt="WebAPI Error Handling Flow Chart" src="/assets/images/web-api-error-handling-flow-9c1b310535069274a42b39288c410b73.png" width="978" height="724"></p>
<h2 id="autogenerate-webapi">Autogenerate WebAPI</h2>
<p>Using the following steps, it is possible to get the CarbonAware WebApi OpenAPI
specification</p>
<ol>
<li>
<p>Make sure the current directory is <code>&lt;path to project root&gt;/src/</code></p>
<pre><code class="language-sh">dotnet restore
cd CarbonAware.WebApi/src
dotnet tool restore
dotnet build --configuration Release --no-restore
dotnet tool run swagger tofile --output ./wwwroot/api/v1/swagger.yaml --yaml bin/Release/net8.0/CarbonAware.WebApi.dll v1
</code></pre>
</li>
<li>
<p>The <code>CarbonAware.WebApi/src/wwwroot/api/v1/swagger.yaml</code> file contains the supported
OpenApi specification.</p>
</li>
<li>
<p>Use for instance <a href="https://editor.swagger.io">swagger editor</a> to see and try
the endpoint routes.</p>
</li>
</ol>
<h2 id="data-sources">Data Sources</h2>
<h3 id="watttime">WattTime</h3>
<h4 id="watttime-locations">WattTime Locations</h4>
<p>Each WattTime emissions data point is associated with a particular named
balancing authority. For transparency, this value is also used in
<code>EmissionsData</code> response objects. It is not overwritten to match the named
datacenter provided by any request.</p>
<blockquote>
<p>&quot;A balancing authority ensures, in real time, that power system demand and
supply are finely balanced. This balance is needed to maintain the safe and
reliable operation of the power system. If demand and supply fall out of
balance, local or even wide-area blackouts can result.&quot;</p>
<p>See <a href="https://www.eia.gov/todayinenergy/detail.php?id=27152">this post</a> on
balancing authories from the EIA to learn more.</p>
</blockquote>
<h4 id="watttime-exception-handling">WattTime Exception Handling</h4>
<p>If WattTime responds with a 4XX or 5XX status code the WattTime Data Source will
forward the response code and message back to the caller. Refer to the
<a href="https://www.watttime.org/api-documentation/">current WattTime documentation</a>
for the most up-to-date information about possible error codes.</p>
<h4 id="example-emissions-call-using-watttime">Example Emissions Call Using WattTime</h4>
<p>The swimlanes diagram below follows an example request for emissions data using
WattTime as the data source provider. In this diagram, the <em>Client</em> is a user of
the SDK and the <em>WattTimeService</em> is the <a href="https://www.wattime.org">WattTime</a>
API.</p>
<p><img alt="webapi to watttime flow diagram" src="/assets/images/webapi-swimlanes-98813b02d7bd1d628ed4b55834ba443f.png" width="1300" height="1034"></p>
<h3 id="electricitymaps">ElectricityMaps</h3>
<h4 id="electricitymaps-locations">ElectricityMaps Locations</h4>
<p>Each ElectricityMaps emissions data point is associated with a particular named
zone. While the ElectricityMaps endpoint supports calling with lat/long
geoposition as well, the result will always be a corresponding zone name. They
provide a
<a href="https://static.electricitymaps.com/api/docs/index.html#zones">route on their API</a>
which can be queried to list all the zone names you have access to given your
token</p>
<h4 id="electricitymaps-exception-handling">ElectricityMaps Exception Handling</h4>
<p>If ElectricityMaps responds with a 4XX or 5XX status code the ElectricityMaps
Data Source will forward the response code and message back to the caller. Refer
to the
<a href="../src/CarbonAware.DataSources/CarbonAware.DataSources.ElectricityMaps/src/Client/ElectricityMapsClientHttpException.cs">ElectricityMapsHttpClientException</a>
class for documentation on expected error codes.</p>
<h3 id="electricitymapsfree">ElectricityMapsFree</h3>
<h4 id="locations">Locations</h4>
<p>Each ElectricityMapsFree emissions data point is associated with a particular
named country code. While the ElectricityMapsFree endpoint supports calling with
lat/long geoposition as well, the result will always be a corresponding country
code.
They provide a
<a href="https://static.electricitymaps.com/api/docs/index.html#zones">route on their parent API (ElectricityMaps)</a>
which can be queried to list all the country codes you have access to given your
token.</p>
<h4 id="exception-handling">Exception Handling</h4>
<p>If ElectricityMapsFree responds with a 4XX or 5XX status code the
ElectricityMapsFree Data Source will forward the response code and message back
to the caller. Refer to the
<a href="../src/CarbonAware.DataSources/CarbonAware.DataSources.ElectricityMapsFree/src/Client/ElectricityMapsFreeClientHttpException.cs">ElectricityMapsFreeHttpClientException</a>
class for documentation on expected error codes.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Green-Software-Foundation/carbon-aware-sdk/docs/tutorial-basics/carbon-aware-webapi.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/tutorial-basics/carbon-aware-tools"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Carbon Aware Tools</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/tutorial-basics/containerization"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Containerized WebApi</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#endpoints" class="table-of-contents__link toc-highlight">Endpoints</a><ul><li><a href="#get-emissionsbylocation" class="table-of-contents__link toc-highlight">GET emissions/bylocation</a></li><li><a href="#get-emissionsbylocations" class="table-of-contents__link toc-highlight">GET emissions/bylocations</a></li><li><a href="#get-emissionsbylocationsbest" class="table-of-contents__link toc-highlight">GET emissions/bylocations/best</a></li><li><a href="#get-emissionsforecastscurrent" class="table-of-contents__link toc-highlight">GET emissions/forecasts/current</a></li><li><a href="#post-emissionsforecastsbatch" class="table-of-contents__link toc-highlight">POST emissions/forecasts/batch</a></li><li><a href="#get-emissionsaverage-carbon-intensity" class="table-of-contents__link toc-highlight">GET emissions/average-carbon-intensity</a></li><li><a href="#post-emissionsaverage-carbon-intensitybatch" class="table-of-contents__link toc-highlight">POST emissions/average-carbon-intensity/batch</a></li><li><a href="#get-locations" class="table-of-contents__link toc-highlight">GET /locations</a></li></ul></li><li><a href="#error-handling" class="table-of-contents__link toc-highlight">Error Handling</a></li><li><a href="#autogenerate-webapi" class="table-of-contents__link toc-highlight">Autogenerate WebAPI</a></li><li><a href="#data-sources" class="table-of-contents__link toc-highlight">Data Sources</a><ul><li><a href="#watttime" class="table-of-contents__link toc-highlight">WattTime</a></li><li><a href="#electricitymaps" class="table-of-contents__link toc-highlight">ElectricityMaps</a></li><li><a href="#electricitymapsfree" class="table-of-contents__link toc-highlight">ElectricityMapsFree</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/quickstart">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/company/green-software-foundation/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/gsfcommunity" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://greensoftwarefdn.slack.com/archives/C02JRAV4QEP" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack (private members only)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://greensoftware.foundation/" target="_blank" rel="noopener noreferrer" class="footer__link-item">greensoftware.foundation</a></li><li class="footer__item"><a href="https://github.com/Green-Software-Foundation/carbon-aware-sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2024 GSF, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>