"use strict";(self.webpackChunkcasdk_docs=self.webpackChunkcasdk_docs||[]).push([[2128],{9006:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>c,toc:()=>u});var i=t(4848),r=t(5680);const a={},o="8. Data Source Configuration",c={id:"architecture/decisions/data-source-configuration",title:"8. Data Source Configuration",description:"Status",source:"@site/docs/architecture/decisions/0008-data-source-configuration.md",sourceDirName:"architecture/decisions",slug:"/architecture/decisions/data-source-configuration",permalink:"/docs/architecture/decisions/data-source-configuration",draft:!1,unlisted:!1,editUrl:"https://github.com/Green-Software-Foundation/carbon-aware-sdk/docs/architecture/decisions/0008-data-source-configuration.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"7. Data Source Interfaces",permalink:"/docs/architecture/decisions/data-source-interfaces"},next:{title:"9. SDK as a C# Client Library",permalink:"/docs/architecture/decisions/sdk-as-a-csharp-client-library"}},s={},u=[{value:"Status",id:"status",level:2},{value:"Date",id:"date",level:2},{value:"Context",id:"context",level:2},{value:"Decision",id:"decision",level:2},{value:"Consequences",id:"consequences",level:2},{value:"Implementation",id:"implementation",level:3},{value:"Green Impact",id:"green-impact",level:2}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,r.RP)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"8-data-source-configuration",children:"8. Data Source Configuration"}),"\n",(0,i.jsx)(n.h2,{id:"status",children:"Status"}),"\n",(0,i.jsx)(n.p,{children:"Accepted"}),"\n",(0,i.jsx)(n.h2,{id:"date",children:"Date"}),"\n",(0,i.jsx)(n.p,{children:"2022-11-1"}),"\n",(0,i.jsx)(n.h2,{id:"context",children:"Context"}),"\n",(0,i.jsx)(n.p,{children:"The current CarbonAware configuration is not intuitive for a user because it\nhides the relationships between entities, and so requires deep reading of the\ndocumentation to properly configure. This challenge is amplified for use-cases\nwhere different interfaces can be configured with different data sources. EG:\nJSON data source for emissions, but WattTime data source for forecast data."}),"\n",(0,i.jsx)(n.h2,{id:"decision",children:"Decision"}),"\n",(0,i.jsx)(n.p,{children:"A top-level 'DataSources' section will specify all of the data source\nconfiguration needs for the consumer."}),"\n",(0,i.jsx)(n.p,{children:"Within that, specific data source configurations will be defined in the\n'Configurations' section. Each item containing the parameters required for\nconfiguring the data source in its entirety EG: client config, file paths,\nadditional parameters, etc."}),"\n",(0,i.jsx)(n.p,{children:"Each data source interface can then be configured by referencing these\n'Configurations' by their key."}),"\n",(0,i.jsx)(n.p,{children:"The resulting 'DataSources' config schema being:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "DataSources": {\n    <DataSourceInterface Key1>: <\'Configurations\' Key String>,\n    <DataSourceInterface Key2>: <\'Configurations\' Key String>,\n    //...\n    "Configurations": {\n      <ConfigKey1>: {\n        "Type": <string enum of data source implementation>,\n        <Additional config key for this type>: <value>,\n        <Additional config key for this type>: <value>,\n        //...\n      },\n      <ConfigKey2>: {\n        //...\n      },\n      //...\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"consequences",children:"Consequences"}),"\n",(0,i.jsx)(n.p,{children:"The configuration scheme is flexible and extensible to support any new\ninterfaces and data sources. It reflects the relationship between data sources\nand all of their relevant configuration values."}),"\n",(0,i.jsx)(n.h3,{id:"implementation",children:"Implementation"}),"\n",(0,i.jsx)(n.p,{children:"Here is an example of the proposed configuration schema change with multiple\npotential data source interfaces:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n "DataSources": {\n    "CarbonIntensityDataSource": "WattTime",\n    "EnergyDataSource": "ElectricityMaps",\n    "EmbodiedCarbonDataSource": "ElectricityMaps",\n    "Configurations": {\n      "WattTime": {\n        "Type": "CarbonAware.DataSources.WattTime",\n        "ClientConfiguration": {\n          "Username": "username",\n          "Password": "password",\n          "BaseURL": "https://api2.watttime.org/v2/"\n        }\n      },\n      "ElectricityMaps": {\n        "Type": "CarbonAware.DataSources.ElectricityMaps",\n        "ClientConfiguration": {\n          "API_Key": "abcd",\n          "BaseURL": "https://api.electricitymap.org/v3/"\n        },\n        "disableEstimations": "true",\n        "emissionsFactorType": "lifecycle"\n      }\n    }\n  }\n'})}),"\n",(0,i.jsxs)(n.p,{children:["During initialization of the interface, the config will read to get the data\nsource associated with it. For example, when a ",(0,i.jsx)(n.code,{children:"CarbonIntensityDataSource"})," is\ninitialized, it will get the corresponding value from the config, which is\n'WattTime' in the above example. It then looks up the value of the 'WattTime'\nkey in the 'Configurations' section. The object retrieved from the config will\nbe then used to load and configure the ",(0,i.jsx)(n.code,{children:"WattTimeDataSource"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:['This "by-reference" configuration enables operators to use the same\nconfiguration for multiple data source interfaces without requiring duplication,\nas shown in the above example with the hypothetical ',(0,i.jsx)(n.code,{children:"EnergyDataSource"})," and\n",(0,i.jsx)(n.code,{children:"EmbodiedCarbonDataSource"})," both using the same ",(0,i.jsx)(n.code,{children:"ElectricityMaps"})," data source."]}),"\n",(0,i.jsx)(n.h2,{id:"green-impact",children:"Green Impact"}),"\n",(0,i.jsx)(n.p,{children:"Neutral"})]})}function d(e={}){const{wrapper:n}={...(0,r.RP)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},5680:(e,n,t)=>{t.d(n,{RP:()=>u});var i=t(6540);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,i,r=function(e,n){if(null==e)return{};var t,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=i.createContext({}),u=function(e){var n=i.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},l={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},d=i.forwardRef((function(e,n){var t=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,d=c(e,["components","mdxType","originalType","parentName"]),h=u(t),f=r,p=h["".concat(s,".").concat(f)]||h[f]||l[f]||a;return t?i.createElement(p,o(o({ref:n},d),{},{components:t})):i.createElement(p,o({ref:n},d))}));d.displayName="MDXCreateElement"}}]);